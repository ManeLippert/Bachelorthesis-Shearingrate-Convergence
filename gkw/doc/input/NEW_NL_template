! GKW NL spectral template, for collisional kinetic core ITG turbulence 
! Initial setup for 256 MPI processes, can also use up to 4 openmp threads per process
! FJC May 2013

&CONTROL
 collisions= .true.,     ! use collisions (setup below)
 non_linear= .true.,
 method= 'EXP',
 meth= 2,
 dtim=   0.005,          ! this is the initial timestep value, code may reduce it
 fac_dtim_est=1.9,       ! linear timestep estimate multiplication factor:
                         ! reduce this by 10% at a time if run is numerically unstable in linear phase
 ntime=    4000,         ! number of data output timesteps
 naverage= 400,          ! timesteps between data outputs
 nlapar= .true.,         ! include A|| field (recommended even for electrostatic runs)
 disp_x   = 0.3,         ! k^4 hyper-dissipation (use negative value for k^2)
 disp_y   = 0.5,         ! k^4 hyper-dissipation (use negative value for k^2)
 disp_par = 0.30,        ! parallel dissipation
 disp_vp  = 0.01,        ! parallel velocity dissipation: keep small with collisions
 order_of_the_scheme= 'fourth_order',   ! finite differences
 ltrapping_arakawa= T,   ! better numerical stability, less disp_[vp/par] required
 ndump_ts  = 100,        ! diagnostic steps between intermediate backup restart files
 read_file= .true.,      ! allows to restart, gkwnlin will set this
 max_sec= 13600,         ! wall time,         gkwnlin will set this
/
&GRIDSIZE
 nmod= 22,         ! no. toroidal modes (inc. zero)
 nx= 169,          ! radial modes (must be odd)
 n_s_grid= 16,     ! parallel grid: might need 24-32 if trapped dynamics are important
 n_mu_grid= 8,     
 n_vpar_grid= 32,  ! might need 48-64 if trapped dynamics are important and collisionality is low 
 number_of_species= 2,
 nperiod= 1,
 n_procs_s= 8,     ! Maximum value = n_s_grid/2,    use maximum possible (first) for best scaling
 n_procs_mu= 4,    ! Maximum value = n_mu_grid/2,   use maximum possible (second) for best scaling
 n_procs_vpar= 4,  ! Maximum value = n_vpar_grid/2, but not good scaling.  Better to use Open MP.
 n_procs_sp= 2,    ! Maximum value = number_of_species
 /
&MODE
 mode_box= .true.,        ! modes are equally spaced on square grid
 krhomax=   1.41000000,   ! ktheta.rho_ref where rho_ref = sqrt(2 Tref/Te) rho_s
                          ! ktheta = kzeta / sqrt(g^22 @ LFS) = 2 pi rho * n_tor / sqrt(g^22 @ LFS)
 ikxspace=5,              ! Integer to control LX/LY ~ ikxspace / (q shat)
 /
&GEOM
 shat =   0.8488,
 q    =   2.1780,
 eps  =   0.1422,
 geom_type= 'circ',              ! including finite epsilon effects
 /
&SPCGENERAL
 beta_ref=   0.0003,             ! use this value for "electrostatic" runs 
 adiabatic_electrons= .false.,
 finit= 'hybrid',                ! use this to get to NL saturation quickly.  Also try 'noise'
 /
&SPECIES
 mass = 1.0,
 z    = 1,
 temp = 1.0,
 dens = 1.0,
 rlt  = 5.7595,
 rln  = 2.2710,
 uprim= 1.4789,
 /
&SPECIES
 mass = 0.00027200,
 z    = -1,
 temp = 0.9095,
 dens = 1.0,
 rlt  = 5.1163,
 rln  = 2.2710,
 uprim= 0.0,
 /
&ROTATION
 vcor=   0.3202,                     ! Mach number
 cf_trap=.false.                     ! centrifugal effects
 cf_drift=.false.                    ! centrifugal effects 
 !toroidal_shear='use_uprim'         ! use for ExB shearing defined by uprim of species 1
 !shear_profile='wavevector_remap'   ! use to enable  ExB shearing
 !t_shear_begin=100.0                ! use to set later start time of ExB shearing
 /
&COLLISIONS
 rref=  1.6678,                    ! in metres
 tref=  1.7248,                    ! in keV
 nref=  4.4044,                    ! in 10^19 m^-3
 zeff=  1.0,                       ! collision operator only, i-e collisionality factor
 pitch_angle= .true.,
 en_scatter= .false.,              ! use only with friction_coll
 friction_coll= .false.,           ! use only with en_scatter
 mom_conservation= .false.,     
 ene_conservation= .false., 
 freq_override= .false.,           ! use this to set ii collision frequency manually below
 coll_freq = 0.001                 ! ii collision frequency
 / 
&DIAGNOSTIC  !> Optional namelist to switch individual diagnostics on / off
             !> The defaults are reasonably small, without any 2D+ output. 
 lfluxes_spectra = T    ! Enable output of ES fluxes spectra - time diagnostic                     (default = T)
 lfluxes_em_spectra = F ! Enable output of EM (apar) fluxes spectra - time diagnostic              (default = F)
 xy_estep = T           ! True for 2D XY output at every large time step, otherwise only last step (default = T)
 xy_bin   = T           ! Write the 2D XY outputs as binary files (recommended if xy_estep = T)    (default = F)
 xy_phi = .true.        ! Electrostatic potential in perp. plane (& spectrum) at LFS midplane      (default = F)
 xy_apar = .true.       ! Parallel vector potential in perpe.    (& spectrum) at LFS midplane      (default = F)
 xy_dens = .true.       ! Per species densities in perpendicular plane at LFS midplane             (default = F)
 xy_temp = .true.       ! Per species temperatures in perpendicular plane at LFS midplane          (default = F)
 xy_current = .false.   ! Per species 2D parallel currents in perp plane at LFS midplane           (default = F)
 xy_current2 = .false.  ! Per species 2D parallel currents^2 in perp plane at LFS midplane         (default = F)
 xy_fluxes = .false.    ! Per species 2D radial electrostatic heat fluxes in perp plane at LFS mp  (default = F)
 xy_fluxes_P = .false.  ! Output also 2D XY particle fluxes for selected fields                    (default = F)
 xy_fluxes_V = .false.  ! Output also 2D XY momentum fluxes for selected fields                    (default = F)
 xy_fluxes_em = .false. ! Output also 2D XY flutter fluxes for selected moments                    (default = F)
 xy_fluxes_k = .false.  ! Output selected fluxes (Flux surface average) also in 2d k-space         (default = F)
 xy_vort = F            ! Flux surface average vorticity spectrum in 2D (spectrum only)            (default = F)
 !xy_slice_ipar = 2     ! Point on the s grid for XY outputs (usually LFS)              (default = n_s_grid/2+1)
 lcalc_energetics = F   ! Calculate energetics / entropy (experimental)                            (default = F) 
 phi3d = .false.        ! 3d electrostatic potential in real space (binary)                        (default = F)
 spc3d = .false.        ! 3d electrostatic potential spectrum (binary)                             (default = F)
 apa3d = .false.        ! 3d electromagentic potential in real space (binary)                      (default = F)
 apc3d = .false.        ! 3d electromagentic potential spectrum (binary)                           (default = F)
 den3d = .false.        ! 3d density for all species in real space (binary) - D3d0*_* files        (default = F)
 ene3d = .false.        ! 3d energy output for all species in real space (binary) - E3d0*_* files  (default = F) 
 lfluxes_detail= F      ! write fluxes as a 6D function of everything (FINAL STEP ONLY)            (default = F) 
 / 
 

