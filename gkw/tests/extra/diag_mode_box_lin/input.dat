nmp=16,1
!Also need to give this case collisions
!Also need to give this case general geom
!Also need to give this case tearning_modes
!Also need to add a restart test.

 &CONTROL 
 silent = .false.,
 order_of_the_scheme = 'fourth_order'
 fac_dtim_est=5.0
 READ_FILE  = .false. !Any easy way to set this to true in test cases?
 NON_LINEAR = .false.
 zonal_adiabatic = .true.,
 METHOD = 'EXP',
 METH   = 2, 
 DTIM   = 0.0005 
 NTIME  = 5,  
 NAVERAGE = 15,
 nlapar = .true., 
 nlbpar = .true.
 collisions = .true.
 disp_par = 1.0
 disp_vp  = 0.2
 lverbose = .true.
! neoclassics = .true.
 /
 &GRIDSIZE
 n_procs_s = 3
 n_procs_vpar = 2
 n_procs_mu = 2
 n_procs_sp = 2
 NX = 13,   !Must be an odd number
 N_s_grid = 21, 
 N_mu_grid = 4,
 nperiod = 1, 
 N_vpar_grid = 8, 
 NMOD = 5,
 number_of_species = 2 ! Number of species. Note: do not count the adiabatic species  
 /
 &MODE
 CHIN    = 0., 
 KTHRHO  = 0.5,
 mode_box = .true., 
 krhomax = 0.6,
 ikxspace = 5, 
 /
 &GEOM 
 SHAT = 0.7,
 Q    = 1.5, 
 EPS  = 0.277
 /
 &SPCGENERAL
 finit="noise"
 beta = 0.134,
 adiabatic_electrons = .false.
 amp_init = 0.5e-2
 wstar = 10.0                   !The normalised magnetic island width, used with tearingmode       (default = 0.E0)
 Ls    = 2.0                    !In the tearing mode initialisation, Ls is the mode damping length (default = 2.E0)
 isl_rot_freq = 0.1             !The rotation frequency of the magnetic island perturbation        (default = 0.0)
 isl_mode = 3                   !Determines which poloidal mode the island is initialised in when mode_box=T. (default = 2)
 tearingmode=T
 /
 &SPECIES 
 MASS  = 1.4352, 
 Z     = 1.0, 
 TEMP  = 1.8769, 
 dens  = 1.00,
 rlt   = 8.5443,
 rln   = 3.0, 
 uprim = 0.50,
 / 
 &SPECIES 
 MASS  = 2.72e-4, 
 Z     = -1.0, 
 TEMP  = 5.4534 	!Having a high electron temp makes things more likely to break
 dens  = 1.0,
 rlt   = 7.9,
 rln   = 3.00, 
 uprim = 0.13,
 / 
 &SPECIES 
 MASS  = 3.5892, 
 Z     = 7.0, 
 TEMP  = 2.3456, 
 dens  = 0.0,
 rlt   = 6.2345,
 rln   = 1.4, 
 uprim = 0.23,
 /
 &ROTATION
 VCOR = 0.1234
 cf_trap=.true.
 cf_drift=.true.
 shear_rate=0.2
 shear_profile='wavevector_remap'
 / 
 &COLLISIONS
 rref = 1.3			!reference major radius used in collision operator
 tref = 1.4			!reference temperature in units of kev used for the collision operator
 nref = 1.5			!reference density in units 10^19 m^-3 used for the collision operator
 pitch_angle = .true.           !These three terms swith on various terms in the collision operator, this one is pitch angle scattering
 en_scatter =  .true.           !Energy scattering term
 friction_coll = .true.
 mom_conservation = .true.
 mass_conserve = .true.
 freq_override = .true.
 coll_freq = 0.0001
 /
 &DIAGNOSTIC
 lcalc_freq = .false.
 lfinal_output = .true.
 lphi_diagnostics = .true.
 /
 &DIAGNOSTIC  !> Optional namelist read in diagnostics.F90 to switch individual diagnostics on / off
              !< This is for the diagnostic switches; some switches from elsewhere will be moved here
 NFLUSH_TS = 2         ! The number of large time steps between flushing fluxes,time etc. to file  (default = 10)
 LPFLUX=T              ! Enable output of pflux in fluxes - time diagnostic                        (default = T)
 LEFLUX=T              ! Enable output of eflux in fluxes - time diagnostic                        (default = T)
 LVFLUX=T              ! Enable output of vflux in fluxes - time diagnostic                        (default = T)
 LFLUXES_SPECTRA=T     ! Enable output of ES fluxes spectra - time diagnostic                      (default = T)
 LFLUXES_EM_SPECTRA=T  ! Enable output of EM (apar) fluxes spectra - time diagnostic               (default = F)
 LFLUXES_DETAIL=T      ! writes the fluxes as a function of s, mu and vpar                         (default = F)
 LPARALLEL_OUTPUT =T   ! writes the output of the moments along the magnetic field                 (default = T)
 LROTATE_PARALLEL=T    ! normalizes the parallel output such that Re[phi(s=0)] = 1.                (default = T)
 LPARALLEL_PHI=T       ! Enable time output of electrostatic potential along field line            (default = T)
 LPARALLEL_APAR=T      ! Enable time output of A_// magnetic  potential along field line           (default = F)
 LMPI_BROKEN_IO=T      ! If MPI_IO fully supports derived datatypes, use F for faster file write   (default = T)
 lisl_follow=T         ! Makes the X-Y diagnostics follow the o-point of rotating magnetic island  (default = T)
 phi3d = T       ! 3d electrostatic potential in real space (binary)                         (default = F)
 spc3d = T       ! 3d electrostatic potential spectrum (binary)                              (default = F)
 apa3d = T       ! 3d electromagentic potential in real space (binary)                       (default = F)
 apc3d = T       ! 3d electromagentic potential spectrum (binary)                            (default = F)
 bpa3d = T       ! 3d compressional magnetic field in real space (binary)                    (default = F)
 bpc3d = T       ! 3d compressional magnetic field spectrum (binary)                         (default = F)
 den3d = T.       ! 3d density for all species in real space (binary) - D3d0*_* files         (default = F)
 ene3d = T.       ! 3d energy output for all species in real space (binary) - E3d0*_* files   (default = F)
 zonal_scale_3d = 0.8  ! Factor by which to scale the zonal flows in the 3D output                 (default = 1.0)
 lphi_diagnostics = T   !Meta switch for 2-D diaganostics for nonlinear or mode_box runs      (default = T)
 xy_phi = T        ! Electrostatic potential in perpendicular plane at LFS midplane            (default = T)
 xy_apar = T       ! Parallel vector potential in perpendicular plane at LFS midplane          (default = F)
 xy_bpar = T       ! Compressional magnetic field in perpendicular plane at LFS midplane       (default = F)
 xy_dens = T      ! Per species densities in perpendicular plane at LFS midplane              (default = F)
 xy_temp = T      ! Per species temperatures in perpendicular plane at LFS midplane           (default = F)
 xy_current = T   ! Per species parallel currents in perp plane at LFS midplane               (default = F)
 xy_fluxes = T    ! Per species radial electrostatic heat fluxes in perp plane at LFS mp      (default = F)
 xy_fluxes_em = T ! Per species radial electromagnetic heat fluxes in perp plane at LFS mp    (default = F)
 xy_fluxes_bpar = T     ! Per species radial compressional heat fluxes in perp plane at LFS mp      (default = F)
 xy_estep = T           ! Logical that enables XY output at every large time step, otherwise output 
                        ! is just at the end of the run                                             (default = F)
 xy_slice_ipar = 11      ! The point on the s grid that the XY outputs are output from (usually LFS) (default = n_s_grid/2+1)
 LWRITE_OUTPUT1  = T     ! Meta switch for all per timestep output (fluxes, time traces, 2D)   (default = T)
 LCALC_FLUXES    = T     ! Calculate fluxes                                                    (default = T)
 LCALC_FREQ      = T    ! Calculate the mode frequencies                                      (default = T)
 LFINAL_OUTPUT   = T     ! Write final output                                                  (default = T)
 screen_output = T       ! Write per timestep data to screen  (fluxes, timestep, growth rates) (default = T) 
 LAMPLITUDES     = T,         ! Amplitudes diagnostic per mode (kx, ky 2D)                          (default = F)
 LGROWTH_RATES   = T          ! Output growth rates diagnostic per toriodial mode (sum over kx)     (default = F)
 LFREQUENCIES    = T          ! Output frequencies diagnostic per toroidal mode (kx=0 only)         (default = F)
 PSI_VELSPACE    = 0.2,1.0,2.0,  ! List psi coordinates of points for velocity space diagnostic        (list max 32)
 ZETA_VELSPACE   = 0.3,1.3,1.2,  ! List zeta coordinates of points for  velocity space diagnostic      (list max 32)
 NPOINTSVEL      = 3          ! Number of points for velocity diagnostic (if xy_dens)   (max = 32)  (default = 0)
 /

