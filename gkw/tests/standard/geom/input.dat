!PERVIOUSLY This test case did not parallelise over all combinations
!together, (issue 36) but this problem has now been fixed
!this case only has one nperiod and may not be stable
!or may have indicated a now fixed problem with the parallel boundary condition
!
! We tried reducing amp_init
! using cosine 2
! These did not fix the problem
! However we checked that all processors had the same geom values as in single processor case
! and the input_geom_new.dat test case gave confidence that it works in general
!
!
&CONTROL				!This namelist is read in control.f90
 order_of_the_scheme = 'fourth_order'	!Scheme is "fourth_order" or "second_order" in space		(default = 'fourth_order')
 parallel_boundary_conditions = "open"
 READ_FILE  = .false.			!Restart from file requires dist files FS00000X for each proc   (default = .false.)
					!You also need a compatible input.dat			
					!You cannot change the parallelization options for a restart 
 NON_LINEAR = .false.			!Include the non linear terms, computationally expensive fft	(default = .false.)
 zonal_adiabatic = .false.,		!True if zonal flows correction is included			(default = .false)
 METH   = 2,			!Time integration: 1 = modified mid point, 2 = 4th order RK, 3 = 3rd order scheme (default = 3)
 DTIM   = 1e-4 			!Time step size (normalized) must be adjusted for kinetic electrons
 NTIME  = 20,			!Number of iterations of NAVERAGE.	
 NAVERAGE = 50,		
 nlapar = .true., 		
 nlphi = .true.			!True if the electrostatic potential is kept in the equations		(default = .true.)
 collisions = .false.		!Turn on the (developmental) collision operator				(default = .false.)
 disp_par = 0.2			!Dissipation coefficient for parallel derivatives. 			(default = 0.2)
 disp_vp  = 0.2			!Dissipation coefficient for parallel velocity space
 lverbose     = .false.         !Switch on verbose code output if it exists anywhere in the code	(default = .false.)
 vp_trap = 0              	!Integer that determines how the parallel velocity grid is set up. 	(default = 0)
                                !If = 0  the parallel velocity of a grid point is constant along the field line and the grid is uniform
				!If = 1 the parallel velocity follows the trapping condition (devlopmental)
 normalized =.true.		!If the distribution function is renormalised every naverage 
 io_format = 'ascii'
 io_testdata = .true.
 silent = .false.
/
!---------------------------------------------------------------------------------------------------------------------
 &GRIDSIZE			!Namelist read in grid.f90
				!Default grids sizes of 0 will not run, hence these must be provided.
 NX = 1,  
 N_s_grid = 21,   	        !Number of grid points along the field line
 NPERIOD = 1, 			!Parameter that specifies the length of the field line,
				!The field line makes 2*nperiod - 1 poloidal turns. For nonlinear runs nperiod should be 1. 
 N_mu_grid   = 8, 		!Total number of magnetic moment grid points 
 N_vpar_grid = 32, 	        !Number of grid points for parallel velocity
 NMOD = 1,			
 number_of_species = 2 		!Number of species. Note: do not count the adiabatic species 
 n_procs_mu=2
 n_procs_s=3
 n_procs_vpar=2
 n_procs_sp=2
 /
!---------------------------------------------------------------------------------------------------------------------
 &MODE				!Namelist read in mode.f90
 CHIN    = 0., 			!Poloidal shift of the ballooning transform				(default = 0)
 KTHRHO  = 2.500000e-01,	!Poloidal wave vector							(default = 0 will not run)
 mode_box = .false.		!Determines if there is a 2D grid of ky,kx. if true use nperiod = 1	
 krhomax = 1.0,			!For mode_ box, the maximum ky used in the simulations			(default = 0 will not run)
 ikxspace = 7, 			!Determines the spacing between the different kx modes			(default = 0 will not run)
 /
!---------------------------------------------------------------------------------------------------------------------
 &GEOM 				!Namelist read in geom.F90 (q and eps read from chease input)
 EPS  = 0.61075                     !Radial coordinate				(default = 1.23e4)
 GEOM_TYPE = 'chease'    	!Switch for the metric
 EQFILE='hamada.Waltz.dat'
 SIGNB = 1
 SIGNJ = 1
 EPS_TYPE = 2
 /
!---------------------------------------------------------------------------------------------------------------------
 &SPCGENERAL			!This namelist read in components.f90
 beta = 0.01,			!Plasma beta
 adiabatic_electrons = .true.   !Adiabatic electrons (alternative is kinetic electrons)		(default = .false.)
				!Note that kinetic electrons require a smaller timestep for stability
 amp_init = 1e3			!Initial amplitude of distribution function			(default = 1e-3)
 finit = "cosine"		!Perturbed distribution function is initialised 
				!Allowed are "noise","cosine" (default), "gauss" or "zonal"	(default = 'cosine')
 /
!---------------------------------------------------------------------------------------------------------------------
 !The species must satify quasi-neutrality.
 !This requires you to set ratios of densities and charge appropriately
 !Note that the if number_of_species above is less than the number in the list below, later ones will not be read in
 !If number_of_species is greater than the number in the in the list below, the program will crash.
 !There are no default values for most of the parameters.

 &SPECIES 			!This namelist read in components.f90
 MASS  = 1.0, 			!Mass in terms of deuterium mass (=2.013 AMU)
 Z     = 1.0, 			!If negative, assumed to be the electrons
 TEMP  = 1.0, 			!Temperature of species scaled by reference temperature as found in “GKW how and why”
 DENS  = 1.0,			!Density of species scaled by reference density as found in “GKW how and why”
 rlt   = 8.0,			!Temperature gradient gradient along minor radius
 rln   = 3.0, 			!Density gradient along minor radius
 uprim = 1.000000e+00,		
 /
 &SPECIES 			!This namelist read in components.f90
 MASS  = 1.5, 			!Mass in terms of deuterium mass (=2.013 AMU) Tritium!
 Z     = 1.0, 			!If negative, assumed to be the electrons
 TEMP  = 1.0, 			!Temperature of species scaled by reference temperature as found in “GKW how and why”
 DENS  = 1.0,			!Density of species scaled by reference density as found in “GKW how and why”
 rlt   = 3.0,			!Temperature gradient gradient along minor radius
 rln   = 3.0, 			!Density gradient along minor radius
 uprim = 0.000000e+00,		
 / 
 &SPECIES 
 MASS  = 2.723e-4, 		!Yes, these are the electrons
 Z     = -1.0, 			!Only electrons may have negative charge. No muons or antiprotons please.
 TEMP  = 1, 
 dens  = 2.0,
 rlt   = 5.0,
 rln   = 3.0, 
 uprim = 2.000000e+00,
 /
!---------------------------------------------------------------------------------------------------------------------
 &ROTATION			!Namelist read in rotation.f90
 VCOR = 0.05
 !shear_profile='wavevector_remap'
 !shear_rate=0.1
 / 
!---------------------------------------------------------------------------------------------------------------------
 &COLLISIONS			!Namelist only used if collisions = true.  Read in collisonop.F90
 rref = 1			!reference major radius used in collision operator
 tref = 1			!reference temperature in units of kev used for the collision operator
 nref = 1			!reference density in units 10^19 m^-3 used for the collision operator
 / 
&DIAGNOSTIC
 lcalc_freq = .false.
/
