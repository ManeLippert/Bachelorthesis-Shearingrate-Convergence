! WARNING
! The miller test case was found to be quite sensitive to the accuracy of the numerical integrals
! To get this one to pass consistently, parallel disspation and adiabitic electrons and a smooth
! initial condition were required, as well as increasing the number of points in the numerical
! integral to 501.  More sensitive cases are likely not to be reprodicible across machines and compilers 

!---------------------------------------------------------------------------------------------------------------------
&CONTROL
 order_of_the_scheme = 'fourth_order'
 parallel_boundary_conditions = "open"
 NON_LINEAR = .false. 
 zonal_adiabatic = .false.
 METHOD = 'EXP' 
 METH   = 2 
 DTIM   = 0.01
 NTIME  = 5
 NAVERAGE = 100
 nlapar = .false.
 !nlbpar = .false.
 collisions = .false.
 disp_par = 0.8
 disp_vp  = 0.2
 disp_x   = 0.0
 disp_y   = 0.0
 lverbose     = .false.
 normalized =.true.
 silent = .false. 
 dt_min = 0.
 io_format = 'ascii'
 io_testdata = .true.
/
!---------------------------------------------------------------------------------------------------------------------
 &GRIDSIZE                        !Namelist read in grid.f90
                                !Default grids sizes of 0 will not run, hence these must be provided.
 NX = 1,                           !Number of radial wave vectors - currently needs to be an odd number for fft
 N_s_grid = 300,                 !Number of grid points along the field line
 NPERIOD = 3,                         !Integer that specifies the length of the field line,
                                !The field line makes 2*nperiod - 1 poloidal turns. For nonlinear, nperiod must be 1. 
                                !Note that for nperiod = 1 and mode_box=true the kx modes are connected 
                                !For other nperiod /= 1 the solution is set to zero at the end of the field line.
 N_mu_grid   = 8,                 !Total number of magnetic moment grid points 
 N_vpar_grid = 16,                 !Number of grid points for parallel velocity (formerly nvpar, which still works)
 NMOD = 1,                        !Total number of binormal modes - do not interact for non-linear runs
 number_of_species = 2                 !Number of species. Note: do not count the adiabatic species 
 n_procs_mu=2
 n_procs_s=2
 n_procs_vpar=2
 n_procs_sp=1
 /
!---------------------------------------------------------------------------------------------------------------------
&MODE
 CHIN    = 0.
 kthrho = 0.6        
 mode_box = .false.
/
&GEOM
 SHAT = 0.76
 Q    = 1.45
 EPS  = 0.1786
 GEOM_TYPE='miller'
 kappa=1.04,
 delta=0.2,
 square=0.5,
 Zmil=0.,
 skappa=-0.024,
 sdelta=0.0035,
 ssquare=0.,
 dRmil=0.,
 dZmil=0.,
 gradp_type='rota_miller'
 gradp=0.,
 curv_effect=.true.
 !beta_rota_miller_type='geom'
 !beta_rota_miller=0.02
/
&SPCGENERAL
 
 beta_type='ref'
 beta_ref= 0.015
 betaprime_type='sp'
 adiabatic_electrons = .false.
/
&SPECIES
 MASS  = 1
 Z     = 1.0
 TEMP  = 1.0
 dens  = 1.0
 rlt   = 9.0
 rln   = 3.0
 uprim = 3.
/
&SPECIES 
 MASS  = 2.77e-4          !sqrt(mi/me)=60
 Z     = -1.0
 TEMP  = 1.0
 dens  = 1.0
 rlt   = 1.0
 rln   = 3.0
 uprim = 0.
/
&ROTATION
VCOR = 1.
cf_drift = .true.
cf_trap = .true.
cf_qncheck=.false.
/
